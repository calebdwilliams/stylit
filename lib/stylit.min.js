export class StyleSheetRegistry{constructor(){this.adopters=new WeakMap;this.registry=new Map;this.observer=new MutationObserver(e=>{e.forEach(e=>{[...e.removedNodes].forEach(e=>{if(this.adopters.has(e)){this.adopters.delete(e)}else if(this.adopters.has(e.shadowRoot)){this.adopters.delete(e.shadowRoot)}})})});this.observer.observe(document.body,{childList:true})}adopt(e,t){const s=this.adopters.get(e)||new Map;if(!s.size){this.adopters.set(e,s)}if(!s.has(t)&&this.get(t)){const r=this.get(t);e.appendChild(r);s.set(t,r);return Promise.resolve(r)}else if(!this.get(t)){return new Promise(r=>{const o=window.setInterval(()=>{if(this.get(t)){const i=this.get(t);e.appendChild(i);s.set(t,i);r(i);window.clearInterval(o)}},200)})}else{return Promise.resolve(s.get(t))}}createSheet(e){const t=document.createElement("style");t.textContent=e;return t}define(e,t){this.registry.set(e,t);return Promise.resolve({name:e})}get(e){return this.createSheet(this.registry.get(e))}load(e,t){return fetch(t).then(e=>e.text()).then(t=>{this.define(e,t);return e})}};